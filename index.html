<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>インフォメーション</title>
  <style>
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 5px; text-align: center; }
    input { width: 100%; box-sizing: border-box; }
    #saveBtn { width: 100%; padding: 5px; }
  </style>
</head>
<body>

<h2>📋 インフォメーション一覧（新しい順）</h2>
<table id="infoTable">
  <thead>
    <tr>
      <th>日付</th><th>時間</th><th>詳細</th><th>担当</th><th>フロア</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<h3>📝 新規登録</h3>
<table>
  <tr>
    <td><input type="date" id="date"></td>
    <td><input type="time" id="time"></td>
    <td><input type="text" id="detail" placeholder="詳細"></td>
    <td><input type="text" id="person" placeholder="担当"></td>
    <td><input type="text" id="floor" placeholder="フロア"></td>
    <td><button id="saveBtn">保存</button></td>
  </tr>
</table>

<script>
const scriptUrl = "https://script.google.com/macros/s/AKfycbwgHLljFz8WCo-nzqnhWL4AkVvFt5yxPP-3fwz5VCx5kvlJpuIhUPGKReJ0ur0rqNP2/exec";

function loadData() {
  fetch(scriptUrl)
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector("#infoTable tbody");
      tbody.innerHTML = "";
      data.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    });
}

document.getElementById("saveBtn").addEventListener("click", () => {
  const row = [
    document.getElementById("date").value,
    document.getElementById("time").value,
    document.getElementById("detail").value.trim(),
    document.getElementById("person").value.trim(),
    document.getElementById("floor").value.trim()
  ];

  if (row.some(val => val === "")) {
    alert("⚠️ すべての項目を入力してください");
    return;
  }

  fetch(scriptUrl, {
    method: "POST",
    body: JSON.stringify(row),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.text())
  .then(msg => {
    alert(msg);
    loadData(); // 再読み込み
  });
});

window.onload = loadData;
</script>

</body>
</html>
