<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</title>
  <style>
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 5px; text-align: center; }
    input { width: 100%; box-sizing: border-box; }
    #saveBtn { width: 100%; padding: 5px; }
  </style>
</head>
<body>

<h2>ğŸ“‹ ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸€è¦§ï¼ˆæ–°ã—ã„é †ï¼‰</h2>
<table id="infoTable">
  <thead>
    <tr>
      <th>æ—¥ä»˜</th><th>æ™‚é–“</th><th>è©³ç´°</th><th>æ‹…å½“</th><th>ãƒ•ãƒ­ã‚¢</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<h3>ğŸ“ æ–°è¦ç™»éŒ²</h3>
<table>
  <tr>
    <td><input type="date" id="date"></td>
    <td><input type="time" id="time"></td>
    <td><input type="text" id="detail" placeholder="è©³ç´°"></td>
    <td><input type="text" id="person" placeholder="æ‹…å½“"></td>
    <td><input type="text" id="floor" placeholder="ãƒ•ãƒ­ã‚¢"></td>
    <td><button id="saveBtn">ä¿å­˜</button></td>
  </tr>
</table>

<script>
const scriptUrl = "https://script.google.com/macros/s/AKfycbwgHLljFz8WCo-nzqnhWL4AkVvFt5yxPP-3fwz5VCx5kvlJpuIhUPGKReJ0ur0rqNP2/exec";

function loadData() {
  fetch(scriptUrl)
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector("#infoTable tbody");
      tbody.innerHTML = "";
      data.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    });
}

document.getElementById("saveBtn").addEventListener("click", () => {
  const row = [
    document.getElementById("date").value,
    document.getElementById("time").value,
    document.getElementById("detail").value.trim(),
    document.getElementById("person").value.trim(),
    document.getElementById("floor").value.trim()
  ];

  if (row.some(val => val === "")) {
    alert("âš ï¸ ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
    return;
  }

  fetch(scriptUrl, {
    method: "POST",
    body: JSON.stringify(row),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.text())
  .then(msg => {
    alert(msg);
    loadData(); // å†èª­ã¿è¾¼ã¿
  });
});

window.onload = loadData;
</script>

</body>
</html>
